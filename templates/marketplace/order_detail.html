{% extends 'marketplace/base_marketplace.html' %}
{% block title %}Заказ #{{ order.id }}{% endblock %}
{% block content %}
<div class="card market-card">
  <h2>Заказ #{{ order.id }}</h2>
  <p>Статус: <span class="badge market-badge">{{ order.get_status_display }}</span></p>
  <p>Создан: {{ order.created_at }}</p>

  <table>
    <thead><tr><th>Товар</th><th>Цена</th><th>Кол-во</th><th>Сумма</th></tr></thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td>{{ r.title }}</td>
        <td>{{ r.price }} ₸</td>
        <td>{{ r.quantity }}</td>
        <td>{{ r.subtotal }} ₸</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <th colspan="3" style="text-align:right">Итого:</th>
        <th>{{ order.total_amount }} ₸</th>
      </tr>
    </tfoot>
  </table>

  <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:12px">
    <a class="btn market-secondary" href="{% url 'marketplace:product_list' %}">В каталог</a>
    <a class="btn market-secondary" href="{% url 'profile' %}">В кабинет</a>
    {% if user.is_staff %}
      <a class="btn market-btn" href="{% url 'marketplace:order_pdf' order.id %}" target="_blank">PDF</a>
      <a class="btn market-secondary" href="{% url 'marketplace:order_change_status' order.id 'paid' %}">Оплачен</a>
      <a class="btn market-secondary" href="{% url 'marketplace:order_change_status' order.id 'shipped' %}">Отправлен</a>
      <a class="btn market-secondary" href="{% url 'marketplace:order_change_status' order.id 'done' %}">Завершён</a>
      <a class="btn market-secondary" href="{% url 'marketplace:order_change_status' order.id 'cancelled' %}">Отменён</a>
    {% endif %}
  </div>
</div>
{% endblock %}
